<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>generic_data_profiling_routine.py</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-light.min.css"
      id="code-theme"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"
    ></script>

    <style>
      .switch { position: relative; display: inline-block; width: 50px; height:
      28px; } .switch input { opacity: 0; width: 0; height: 0; } .slider {
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc; -webkit-transition: 0.4s; transition: 0.4s; }
      .slider:before { position: absolute; content: ""; height: 20px; width:
      20px; left: 4px; bottom: 4px; background-color: white; -webkit-transition:
      0.4s; transition: 0.4s; } input:checked + .slider { background-color:
      #282c34; } input:focus + .slider { box-shadow: 0 0 1px #282c34; }
      input:checked + .slider:before { -webkit-transform: translateX(20px);
      -ms-transform: translateX(20px); transform: translateX(20px); } .slider.round { border-radius: 28px; } .slider.round:before {
      border-radius: 50%; } .summary { display: flex; font-family: Arial,
      sans-serif; font-size: 16px; color: #333; align-items: center; gap: 10px;
      justify-content: space-between; } .summary-toggle { display: flex; gap:
      10px; align-items: center;} pre { margin: 0; height: fit-content; }

    </style>
  </head>
  <body>
    <div class="summary">
      <p><em>generic_data_profiling_routine.py</em></p>
      <div class="summary-toggle">
        <p>Toggle Theme</p>
        <label class="switch">
          <input type="checkbox" id="checkbox" />
          <span class="slider round"></span>
        </label>
      </div>
    </div>
    <pre>
      <code class=python>from typing import Dict, Any, Tuple
import pandas as pd

def check_null_ratio(series: pd.Series, max_ratio: float) -&gt; str | None:
    &quot;&quot;&quot;Check if null ratio exceeds threshold.&quot;&quot;&quot;
    ratio &#x3D; series.isnull().mean()

    if ratio &gt; max_ratio:
        return f&quot;High null ratio: {ratio:.2f}&quot;
    
    return None

def check_value_range(series: pd.Series, expected_range: Tuple[float, float]) -&gt; str | None:
    &quot;&quot;&quot;Check if numeric values fall outside expected range.&quot;&quot;&quot;
    if not pd.api.types.is_numeric_dtype(series):
        return None
    
    min_val, max_val &#x3D; series.min(), series.max()

    if min_val &lt; expected_range[0] or max_val &gt; expected_range[1]:
        return f&quot;Value out of range: ({min_val}, {max_val})&quot;
    
    return None

def profile_column(series: pd.Series, rules: Dict[str, Any]) -&gt; str | None:
    &quot;&quot;&quot;Apply profiling checks to a single column.&quot;&quot;&quot;
    alert &#x3D; check_null_ratio(series, rules.get(&quot;max_null_ratio&quot;, 1.0))

    if alert:
        return alert
    if &quot;value_range&quot; in rules:
        return check_value_range(series, rules[&quot;value_range&quot;])
    
    return None

def profile_data(df: pd.DataFrame, thresholds: Dict[str, Any]) -&gt; Dict[str, str]:
    &quot;&quot;&quot;Profile DataFrame and return alerts for rule violations.&quot;&quot;&quot;
    alerts &#x3D; {}

    for col in df.columns:
        alert &#x3D; profile_column(df[col], thresholds.get(col, {}))
        if alert:
            alerts[col] &#x3D; alert

    return alerts

def main() -&gt; None:
    # Example data ingestion
    df &#x3D; pd.DataFrame({
        &quot;age&quot;: [25, 30, None, 45, 120],
        &quot;income&quot;: [50000, 60000, 70000, None, 250000]
    })

    # Example alert configuration
    thresholds &#x3D; {
        &quot;age&quot;: {&quot;max_null_ratio&quot;: 0.1, &quot;value_range&quot;: (18, 99)},
        &quot;income&quot;: {&quot;max_null_ratio&quot;: 0.2, &quot;value_range&quot;: (10000, 200000)}
    }

    alerts &#x3D; profile_data(df, thresholds)

    for col, msg in alerts.items():
        print(f&quot;{col}: {msg}&quot;)

if __name__ &#x3D;&#x3D; &quot;__main__&quot;:
    main()</code>
    </pre>
    <script>hljs.highlightAll();</script>
    <script>
      const LIGHT_THEME =
      'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-light.min.css';
      const DARK_THEME =
      'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-dark.min.css';
      const toggleButton = document.getElementById('checkbox'); const codeTheme
      = document.getElementById('code-theme');
      toggleButton.addEventListener('click', () => { if
      (codeTheme.getAttribute('href') === LIGHT_THEME) { codeTheme.setAttribute(
      'href', DARK_THEME ); } else { codeTheme.setAttribute( 'href', LIGHT_THEME
      ); } });
    </script>
  </body>
</html>